var Monithon={config:{lang:"it"},init:function(){console.log("MONITHON V3.0"),this.selects(),this.validateForms(),this.bootstrapComponents(),this.fileFieldDuplicator(),this.linkFieldDuplicator(),this.videoFieldDuplicator(),this.checkEval(),this.delRepoElement(),this.tabSubNav(),this.subjectMultiply(),this.triggerDescriptions()},selects:function(){$(".pck").selectpicker()},validateForms:function(){window.addEventListener("load",function(){var a=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(a,function(a){a.addEventListener("submit",function(b){!1===a.checkValidity()&&(b.preventDefault(),b.stopPropagation()),a.classList.add("was-validated")},!1)})},!1)},bootstrapComponents:function(){$('[data-toggle="tooltip"]').tooltip(),$(".custom-file-input").on("change",function(a){var b=$(this).val().replace("C:\\fakepath\\","");$(this).next(".custom-file-label").text(b)})},fileFieldDuplicator:function(){var a=$(".file-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".file-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="file-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},linkFieldDuplicator:function(){var a=$(".link-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".link-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="link-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},videoFieldDuplicator:function(){var a=$(".video-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".video-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="video-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},checkEval:function(){$(".check-eval").change(function(a){$(this).val()<4?$("#cause_inefficacia_wrapper").removeClass("d-none"):$("#cause_inefficacia_wrapper").addClass("d-none")})},triggerDescriptions:function(){$(".trigger-desc").change(function(){var a=$(this).data("group");$("div").find("[data-group='"+a+"']").each(function(){if($(this).parent().next().hasClass("trigger-desc-wrapper")){var a=$(this).parent().next().attr("id");console.log("adding d-none to el ID: "+a),$(this).parent().next().addClass("d-none")}});var b=$(this).data("target");$(this).is(":checked")&&$(b).removeClass("d-none")})},delRepoElement:function(){$(".ajx-delete-repo").click(function(a){var b=$(this).data("type"),c=$(this).data("id"),d=$(this);$.getJSON("/ajax/delete_repo_ref/"+b+"/"+c,{type:b,id:c}).done(function(a){if(200==a.code)var b='<div class="alert alert-success" role="alert"><i class="fal fa-tick"></i> '+a.msg+"</div>";else var b='<div class="alert alert-warning" role="alert"><i class="fal fa-times"></i> '+a.msg+"</div>";d.after(b),200==a.code&&setTimeout(function(){d.parent().remove()},3e3)})})},tabSubNav:function(){$(".tab-subnav").click(function(){var a=$(this).data("step");$(".tab-pane, .nav-link").removeClass("active").removeClass("show"),$(a).addClass("active").addClass("show"),$(a+"-tab").addClass("active"),window.scrollTo(0,0)})},subjectMultiply:function(){$("#subject-button-add").click(function(a){a.preventDefault();var b=$("#connection-0").clone();$("#subjects-table > tbody").append(b),b.removeAttr("id");var c=$("#subjects-table tbody tr").length,d={cSubject:"connection["+c+"][subject]",cRole:"connection["+c+"][role]",cOrg:"connection["+c+"][organisation]",cType:"connection["+c+"][connection_type]"};b.find(".c-subject").attr("name",d.cSubject),b.find(".c-role").attr("name",d.cRole),b.find(".c-org").attr("name",d.cOrg),b.find(".c-type").attr("name",d.cType).attr("id",d.cType),console.log(b.find("#"+d.cType)),b.find(".c-type").selectpicker("refresh"),b.find(".c-type").change(function(a){if(6==$(this).val()){var b='<input type="text" name="connection['+c+'][connection_type_other]" class="c-other form-control">';$(this).after(b)}else $(this).next(".c-other").length>0&&$(this).next(".c-other").remove()})})}};$(document).ready(function(){Monithon.init()});