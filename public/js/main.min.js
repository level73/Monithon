var Monithon={config:{lang:"it"},init:function(){console.log("MONITHON V3.0"),this.selects(),this.validateForms(),this.bootstrapComponents(),this.fileFieldDuplicator(),this.linkFieldDuplicator(),this.videoFieldDuplicator(),this.checkEval(),this.delRepoElement(),this.tabSubNav(),this.subjectMultiply(),this.showhide(),this.triggerDescriptions(),this.radioDisplayTrigger(".gender_equality_trigger"),this.giudizioSintetico(),this.extraQuestionario()},selects:function(){$(".pck").selectpicker()},validateForms:function(){window.addEventListener("load",function(){var a=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(a,function(a){a.addEventListener("submit",function(b){!1===a.checkValidity()&&(b.preventDefault(),b.stopPropagation()),a.classList.add("was-validated")},!1)})},!1)},bootstrapComponents:function(){$('[data-toggle="tooltip"]').tooltip(),$(".custom-file-input").on("change",function(a){var b=$(this).val().replace("C:\\fakepath\\","");$(this).next(".custom-file-label").text(b)})},fileFieldDuplicator:function(){var a=$(".file-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".file-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="file-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},linkFieldDuplicator:function(){var a=$(".link-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".link-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="link-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},videoFieldDuplicator:function(){var a=$(".video-duplicator").data("duplicate"),b=$(a),c=b.clone(!0);c.removeClass("origin"),$(".video-duplicator").click(function(b){b.preventDefault();var d=c.clone(!0),e=$(a).length,f=d.find("input").first(),g=d.find("label").first(),h="video-attachment["+e+"]";f.attr("id",h).attr("name",h),g.attr("for",h),$(this).before(d)})},checkEval:function(){$(".check-eval").change(function(a){$("input#sda_2").is(":checked")||$("input#sda_4").is(":checked")||$("input#sda_5").is(":checked")||$("input#giudizio_sintetico_2").is(":checked")||$("input#giudizio_sintetico_3").is(":checked")?$("#cause_inefficacia_wrapper").removeClass("d-none"):$("#cause_inefficacia_wrapper").addClass("d-none")})},triggerDescriptions:function(){$(".trigger-desc").change(function(){var a=$(this).data("group");$("div").find("[data-group='"+a+"']").each(function(){if($(this).parent().next().hasClass("trigger-desc-wrapper")){var a=$(this).parent().next().attr("id");console.log("adding d-none to el ID: "+a),$(this).parent().next().addClass("d-none")}});var b=$(this).data("target");$(this).is(":checked")&&$(b).removeClass("d-none")})},showhide:function(){$(".showhide").click(function(){var a=$(this).data("target");$(a).hasClass("d-none")?($(a).removeClass("d-none"),$(this).text($(this).text().replace("compila","nascondi"))):($(a).addClass("d-none"),$(this).text($(this).text().replace("nascondi","compila")))})},radioDisplayTrigger:function(a){$(a).change(function(){var a=$(this).data("target");$(a).addClass("d-none"),$(this).is(":checked")&&1==$(this).val()&&$(a).removeClass("d-none")})},delRepoElement:function(){$(".ajx-delete-repo").click(function(a){var b=$(this).data("type"),c=$(this).data("id"),d=$(this);$.getJSON("/ajax/delete_repo_ref/"+b+"/"+c,{type:b,id:c}).done(function(a){if(200==a.code)var b='<div class="alert alert-success" role="alert"><i class="fal fa-tick"></i> '+a.msg+"</div>";else var b='<div class="alert alert-warning" role="alert"><i class="fal fa-times"></i> '+a.msg+"</div>";d.after(b),200==a.code&&setTimeout(function(){d.parent().remove()},3e3)})})},tabSubNav:function(){$(".tab-subnav").click(function(){var a=$(this).data("step");$(".tab-pane, .nav-link").removeClass("active").removeClass("show"),$(a).addClass("active").addClass("show"),$(a+"-tab").addClass("active"),window.scrollTo(0,0)})},subjectMultiply:function(){$("#subject-button-add").click(function(a){a.preventDefault();var b=$("#connection-0").clone();$("#subjects-table > tbody").append(b),b.removeAttr("id");var c=$("#subjects-table tbody tr").length,d={cSubject:"connection["+c+"][subject]",cRole:"connection["+c+"][role]",cOrg:"connection["+c+"][organisation]",cType:"connection["+c+"][connection_type]"};b.find(".c-subject").attr("name",d.cSubject),b.find(".c-role").attr("name",d.cRole),b.find(".c-org").attr("name",d.cOrg),b.find(".c-type").attr("name",d.cType).attr("id",d.cType),console.log(b.find("#"+d.cType)),b.find(".c-type").selectpicker("refresh"),b.find(".c-type").change(function(a){if(6==$(this).val()){var b='<input type="text" name="connection['+c+'][connection_type_other]" class="c-other form-control">';$(this).after(b)}else $(this).next(".c-other").length>0&&$(this).next(".c-other").remove()})})},giudizioSintetico:function(){Monithon.setGS(),$('input[name="stato_di_avanzamento"]').on("change",function(){Monithon.setGS()})},setGS:function(){var a={giudizio_sintetico_1:"Potenzialmente efficace <small>Il progetto sembra utile e complessivamente ben progettato, anche se potenziali rischi possono essere individuati</small>",giudizio_sintetico_2:"Potenzialmente efficace ma con rischi sostanziali <small>Il progetto sembra utile, anche se ci sono debolezze o rischi importanti che ne possono pregiudicare l’efficacia</small>",giudizio_sintetico_3:"Inutile o dannoso <small>Non andava finanziato: non serve o può avere conseguenze negative, oppure la progettazione è largamente insufficiente per raggiungere gli obiettivi</small>",giudizio_sintetico_4:"Non è stato possibile valutare <small>Le informazioni disponibili non sono sufficienti; i soggetti coinvolti non ci hanno risposto</small>"},b={giudizio_sintetico_1:"Potenzialmente efficace <small>Il progetto sembra utile e il suo sviluppo incoraggiante, anche se potenziali rischi possono essere individuati</small>",giudizio_sintetico_2:"Potenzialmente efficace ma con problemi <small>Il progetto sembra complessivamente utile ma ci sono debolezze o rischi importanti che ne possono pregiudicare l’efficacia, non legati a ritardi o problemi realizzativi</small>",giudizio_sintetico_3:"Intervento inutile o dannoso <small>Non andava finanziato: non serve o può avere conseguenze negative, oppure la realizzazione presenta problemi che rendono impossibile raggiungere gli obiettivi</small>",giudizio_sintetico_4:"Non è stato possibile valutare <small>Le informazioni disponibili non sono sufficienti; i soggetti coinvolti non ci hanno risposto</small>"},c={giudizio_sintetico_1:"Intervento efficace <small>Gli aspetti positivi prevalgono ed è giudicato complessivamente efficace dal punto di vista dell'utente finale</small>",giudizio_sintetico_2:"Intervento utile ma presenta problemi <small>Ha avuto alcuni risultati positivi ed è tutto sommato utile, anche se presenta aspetti negativi significativi</small>",giudizio_sintetico_3:"Intervento inefficace o dannoso <small>Era meglio non finanziarlo perché non ha provocato alcun effetto o ha provocato effetti negativi</small>",giudizio_sintetico_4:"Non è stato possibile valutare <small>Es. il progetto non ha ancora prodotto risultati valutabili</small>"},d=$('input[name="stato_di_avanzamento"]:checked').val();if(d<3)var e=a;else if(d>2&&d<6)var e=b;else var e=c;$(".gsl").each(function(){var a=$(this).attr("for"),b=e[a];$(this).html(b)})},triggerProblems:function(){var a=!1,b=$("#problems_found");$(".checkforproblems").each(function(){$(this).is(":checked")&&(a=!0)}),!0===a?b.removeClass("d-none"):b.addClass("d-none"),$('input[name="gs"], input[name="stato_di_avanzamento"]').change(function(){Monithon.triggerProblems()})},extraQuestionario:function(){Monithon.showExtraQ(),$("input#questionario_altri, input#questionario_utenti").change(function(){Monithon.showExtraQ()})},showExtraQ:function(){$("input#questionario_altri").is(":checked")||$("input#questionario_utenti").is(":checked")?$(".qe_w").removeClass("d-none"):$(".qe_w").addClass("d-none")}};$(document).ready(function(){Monithon.init()});